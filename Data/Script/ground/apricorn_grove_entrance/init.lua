--[[
    init.lua
    Created: 07/13/2023 19:44:56
    Description: Autogenerated script file for the map apricorn_grove_entrance.
]]--
-- Commonly included lua functions and data
require 'common'
require 'PartnerEssentials'
require 'ground.apricorn_grove_entrance.apricorn_grove_entrance_ch_4'

-- Package name
local apricorn_grove_entrance = {}

-- Local, localized strings table
-- Use this to display the named strings you added in the strings files for the map!
-- Ex:
--      local localizedstring = MapStrings['SomeStringName']
local MapStrings = {}

-------------------------------
-- Map Callbacks
-------------------------------
---apricorn_grove_entrance.Init(map)
--Engine callback function
function apricorn_grove_entrance.Init(map)

	DEBUG.EnableDbgCoro()
	print('=>> Init_apricorn_grove_entrance <<=')
	MapStrings = COMMON.AutoLoadLocalizedStrings()
	COMMON.RespawnAllies()
	PartnerEssentials.InitializePartnerSpawn()

end

---apricorn_grove_entrance.Enter(map)
--Engine callback function
function apricorn_grove_entrance.Enter(map)

  apricorn_grove_entrance.PlotScripting()

end

---apricorn_grove_entrance.Exit(map)
--Engine callback function
function apricorn_grove_entrance.Exit(map)


end

---apricorn_grove_entrance.Update(map)
--Engine callback function
function apricorn_grove_entrance.Update(map)


end

---apricorn_grove_entrance.GameSave(map)
--Engine callback function
function apricorn_grove_entrance.GameSave(map)

	PartnerEssentials.SaveGamePartnerPosition(CH('Teammate1'))

end

---apricorn_grove_entrance.GameLoad(map)
--Engine callback function
function apricorn_grove_entrance.GameLoad(map)

	PartnerEssentials.LoadGamePartnerPosition(CH('Teammate1'))
	apricorn_grove_entrance.PlotScripting()

end


function apricorn_grove_entrance.PlotScripting()
	if SV.ChapterProgression.Chapter == 4 then 
		if not SV.Chapter3.EnteredCavern then
			apricorn_grove_entrance_ch_3.FirstAttemptCutscene()
		elseif not SV.Chapter3.EncounteredBoss then
			apricorn_grove_entrance_ch_3.LostBeforeStyle()
		else 
			apricorn_grove_entrance_ch_3.LostToStyle()
		end
	else
		GAME:FadeIn(20)
	end
end

-------------------------------
-- Entities Callbacks
-------------------------------
function apricorn_grove_entrance.Teammate1_Action(chara, activator)
  DEBUG.EnableDbgCoro() --Enable debugging this coroutine
  PartnerEssentials.GetPartnerDialogue(CH('Teammate1'))
 end
 
return apricorn_grove_entrance

